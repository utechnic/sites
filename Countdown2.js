/**
 * @module   αCountdown
 * @version  v0.1.1
 * @author   OXAYAZA {@link https://github.com/OXAYAZA}
 * @license  CC BY-SA 4.0 {@link https://creativecommons.org/licenses/by-sa/4.0/}
 * @requires module:αUtil
 * @requires module:αProgressCircle
 * @see      {@link https://oxayaza.page.link/gitHub_aCounters}
 */
function aCountdown(t){function n(t){if(!t||!t.node||void 0===t.to)throw Error("Missing of bad required αCountdown parameters (node, from, to).");for(var n in this.params=Util.merge([this.defaults,t],{skipNull:!0}),(this.params.node.countdown=this).internal.to=Number(new Date(this.params.to)),this.internal.from=this.params.from?Number(new Date(this.params.from)):this.internal.to-this.constant.year,this.internal.counters)this.internal.counters[n]=this.params.node.querySelector("[data-counter-"+n+"]");for(var n in this.internal.circles)this.internal.circles[n]=this.params.node.querySelector("[data-progress-"+n+"]"),this.internal.circles[n]&&aProgressCircle({node:this.internal.circles[n]});this.run()}return n.prototype.defaults={from:null,to:null,tick:1e3,count:"auto",onTick:null},n.prototype.constant={second:1e3,minute:6e4,hour:36e5,day:864e5,year:31536e6},n.prototype.internal={from:null,to:null,now:null,counters:{days:null,hours:null,minutes:null,seconds:null},circles:{days:null,hours:null,minutes:null,seconds:null},period:{full:null,now:null},time:{days:null,hours:null,minutes:null,seconds:null},angle:{days:null,hours:null,minutes:null,seconds:null},tmp:{days:null,hours:null,minutes:null}},n.prototype.calc=function(){this.internal.time.days=this.internal.period.now/this.constant.day,this.internal.angle.days=360/~~(this.internal.period.full/this.constant.day)*~~this.internal.time.days||0,this.internal.tmp.days=~~this.internal.time.days*this.constant.day,this.internal.time.hours=(this.internal.period.now-this.internal.tmp.days)/this.constant.hour,this.internal.angle.hours=15*this.internal.time.hours,this.internal.tmp.hours=~~this.internal.time.hours*this.constant.hour,this.internal.time.minutes=(this.internal.period.now-(this.internal.tmp.days+this.internal.tmp.hours))/this.constant.minute,this.internal.angle.minutes=6*this.internal.time.minutes,this.internal.tmp.minutes=~~this.internal.time.minutes*this.constant.minute,this.internal.time.seconds=(this.internal.period.now-(this.internal.tmp.days+this.internal.tmp.hours+this.internal.tmp.minutes))/this.constant.second,this.internal.angle.seconds=6*this.internal.time.seconds},n.prototype.mode=function(){this.internal.now=Number(new Date),this.internal.to>this.internal.now&&-1<["auto","until"].indexOf(this.params.count)?(this.internal.period.full=this.internal.to-this.internal.from,this.internal.period.now=this.internal.to-this.internal.now):this.internal.to<this.internal.now&&-1<["auto","since"].indexOf(this.params.count)&&(this.internal.period.full=this.internal.to-this.internal.from,this.internal.period.now=this.internal.now-this.internal.to)},n.prototype.render=function(){for(var t in this.mode(),this.calc(),this.internal.counters)this.internal.counters[t]&&(this.internal.counters[t].innerText=~~this.internal.time[t]),this.internal.circles[t]&&this.internal.circles[t].progressCircle.render(this.internal.angle[t])},n.prototype.run=function(){this.render(),setInterval(function(){this.render(),this.params.onTick instanceof Function&&this.params.onTick.call(this)}.bind(this),this.params.tick)},new n(t)}!function(){var t=navigator.userAgent.toLowerCase(),n=(new Date,$(document),$(window)),i=$("html"),s=($("body"),i.hasClass("desktop"),-1!==t.indexOf("msie")?parseInt(t.split("msie")[1],10):-1!==t.indexOf("trident")||t.indexOf("edge"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),{counter:document.querySelectorAll(".counter"),progressLinear:document.querySelectorAll(".progress-linear"),progressCircle:document.querySelectorAll(".progress-circle")});n.on("load",function(){if(s.counter)for(var t=0;t<s.counter.length;t++){var n=s.counter[t],i=aCounter({node:n,duration:n.getAttribute("data-duration")||1e3}),e=function(){Util.inViewport(this)&&!this.classList.contains("animated-first")&&(this.counter.run(),this.classList.add("animated-first"))}.bind(n);(function(){this.counter.params.to=parseInt(this.textContent,10),this.counter.run()}).bind(n);e(),window.addEventListener("scroll",e)}if(s.progressLinear)for(t=0;t<s.progressLinear.length;t++){var r=s.progressLinear[t];(i=aCounter({node:r.querySelector(".progress-linear-counter"),duration:r.getAttribute("data-duration")||1e3,onStart:function(){this.custom.bar.style.width=this.params.to+"%"}})).custom={container:r,bar:r.querySelector(".progress-linear-bar"),onScroll:function(){Util.inViewport(this.custom.container)&&!this.custom.container.classList.contains("animated")&&(this.run(),this.custom.container.classList.add("animated"))}.bind(i),onBlur:function(){this.params.to=parseInt(this.params.node.textContent,10),this.run()}.bind(i)},i.custom.onScroll(),document.addEventListener("scroll",i.custom.onScroll)}if(s.progressCircle)for(t=0;t<s.progressCircle.length;t++){r=s.progressCircle[t];(i=aCounter({node:r.querySelector(".progress-circle-counter"),duration:500,onUpdate:function(t){this.custom.bar.render(3.6*t)}})).params.onComplete=i.params.onUpdate,i.custom={container:r,bar:aProgressCircle({node:r.querySelector(".progress-circle-bar")}),onScroll:function(){Util.inViewport(this.custom.container)&&!this.custom.container.classList.contains("animated")&&(this.run(),this.custom.container.classList.add("animated"))}.bind(i),onBlur:function(){this.params.to=parseInt(this.params.node.textContent,10),this.run()}.bind(i)},i.custom.onScroll(),window.addEventListener("scroll",i.custom.onScroll)}})}();